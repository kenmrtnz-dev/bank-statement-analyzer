# App
APP_ENV=dev
DATA_DIR=./data

# Redis / Celery
REDIS_URL=redis://redis:6379/0
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/0
CELERY_TASK_DEFAULT_QUEUE=jobs
CELERY_WORKER_PREFETCH_MULTIPLIER=1
CELERY_VISIBILITY_TIMEOUT_SECONDS=3600
CELERY_RESULT_EXPIRES_SECONDS=86400
CELERY_TASK_SOFT_TIME_LIMIT=7200
CELERY_TASK_TIME_LIMIT=7500
CELERY_TASK_MAX_RETRIES=3
CELERY_TASK_RETRY_BACKOFF_SECONDS=15
CELERY_TASK_RETRY_BACKOFF_MAX_SECONDS=300
CELERY_TASK_RETRY_JITTER_SECONDS=3

# DB (default local sqlite for fast dev; uncomment Postgres URL when using docker-compose db service)
DATABASE_URL=sqlite:///./data/ocr.db

# Schema management
DB_AUTO_CREATE_SCHEMA=true

# Postgres (optional)
POSTGRES_HOST=db
POSTGRES_PORT=5432
POSTGRES_DB=ocr
POSTGRES_USER=ocr
POSTGRES_PASSWORD=ocrpass
# DATABASE_URL=postgresql+psycopg://ocr:ocrpass@db:5432/ocr

# Auth / JWT
JWT_SECRET=change-me
JWT_ISS=ocr-webapp
JWT_EXP_SECONDS=43200
# Default users are for local bootstrap only.
# In non-dev environments, set SEED_DEFAULT_USERS=false unless explicitly needed.
SEED_DEFAULT_USERS=true
DEFAULT_AGENT_EMAIL=agent@example.com
DEFAULT_AGENT_PASSWORD=agent123
DEFAULT_EVALUATOR_EMAIL=evaluator@example.com
DEFAULT_EVALUATOR_PASSWORD=evaluator123
DEFAULT_ADMIN_EMAIL=admin@example.com
DEFAULT_ADMIN_PASSWORD=admin123

CELERY_CONCURRENCY=4
CELERY_MAX_TASKS_PER_CHILD=25
PADDLE_PDX_DISABLE_MODEL_SOURCE_CHECK=True

# AI profile analyzer
AI_ANALYZER_ENABLED=true
AI_ANALYZER_PROVIDER=gemini
AI_ANALYZER_MODEL=gemini-2.5-flash
AI_ANALYZER_TIMEOUT_SEC=20
AI_ANALYZER_SAMPLE_PAGES=3
AI_ANALYZER_MIN_ROWS=3
AI_ANALYZER_MIN_DATE_RATIO=0.80
AI_ANALYZER_MIN_BAL_RATIO=0.80
GEMINI_API_KEY=

# OpenAI OCR row extraction mode
OPENAI_OCR_USE_STRUCTURED_ROWS=true
OPENAI_OCR_RPM_LIMIT=60
OPENAI_OCR_RATE_WINDOW_SECONDS=60
OPENAI_OCR_RATE_KEY=openai:ocr:rpm
OPENAI_OCR_RATE_WAIT_TIMEOUT_SECONDS=120

# EspoCRM integration (evaluator CRM file retrieval)
ESPOCRM_BASE_URL=https://staging-crm.discoverycsc.com/api/v1
ESPOCRM_API_KEY=
CRM_ATTACHMENT_PROBE_MODE=lazy
CRM_ATTACHMENT_CACHE_TTL_SECONDS=90
CRM_ATTACHMENT_PROBE_CONCURRENCY=12
